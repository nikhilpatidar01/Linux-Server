### **What is ClamAV in Linux?**  

**ClamAV (Clam AntiVirus)** is a free, open-source antivirus software designed for **Linux, Windows, and macOS**. It is primarily used on **Linux servers and desktops** to scan files, emails, and web uploads for **viruses, malware, and trojans**.  

---

## **Key Features of ClamAV**  
âœ… **Cross-Platform Support** â€“ Works on Linux, Windows, and macOS.  
âœ… **Command-Line Based** â€“ Lightweight and runs through the terminal.  
âœ… **Automatic Virus Database Updates** â€“ Uses `freshclam` to stay up to date.  
âœ… **Scans Emails & Files** â€“ Protects mail servers and file servers.  
âœ… **Archive Scanning** â€“ Supports ZIP, RAR, TAR, 7z, etc.  
âœ… **On-Access Scanning** â€“ Can run in the background with `clamd` daemon.  
âœ… **Lightweight & Fast** â€“ Does not slow down the system.  

---

## **How ClamAV Works in Linux?**  

1. **Installation** â€“ Install using `apt`, `yum`, or `pacman`.  
2. **Update Virus Database** â€“ Keep virus signatures updated using `freshclam`.  
3. **Manual Scanning** â€“ Use `clamscan` to scan files and directories.  
4. **Daemon Mode (Optional)** â€“ Use `clamd` for real-time scanning.  
5. **Action on Threats** â€“ Reports, quarantines, or removes infected files.  

---

## **Where is ClamAV Used?**  
ðŸ”¹ **Mail Servers** â€“ Scans emails for malware (e.g., Postfix, Exim).  
ðŸ”¹ **File Servers** â€“ Checks uploaded/downloaded files for viruses.  
ðŸ”¹ **Web Servers** â€“ Protects against malicious uploads.  
ðŸ”¹ **Personal Linux Systems** â€“ For manual virus scanning.  

---

## **Why Use ClamAV in Linux?**  
Although **Linux is less prone to viruses**, ClamAV is useful for:  
âœ” Scanning files before sharing them with Windows users.  
âœ” Detecting **rootkits, trojans, and malicious scripts**.  
âœ” Securing **email and web servers** from malware.  

---

### **1. Install ClamAV**
#### **On Debian/Ubuntu:**
```bash
sudo apt update
sudo apt install clamav clamav-daemon
```
#### **On RHEL/CentOS:**
```bash
sudo yum install epel-release -y
sudo yum install clamav clamav-update -y
```
#### **On Arch Linux:**
```bash
sudo pacman -S clamav
```

---

### **2. Update ClamAV Virus Database**
```bash
sudo freshclam
```

---

### **3. Scan Files & Directories**
#### **Scan a single file:**
```bash
clamscan /path/to/file
```
#### **Scan a directory recursively:**
```bash
clamscan -r /path/to/directory
```
#### **Scan and remove infected files:**
```bash
clamscan -r --remove /path/to/directory
```
#### **Scan and move infected files to quarantine:**
```bash
clamscan -r --move=/path/to/quarantine /path/to/directory
```
#### **Scan only infected files (hide clean files):**
```bash
clamscan -r --infected /path/to/directory
```
#### **Scan and log the output:**
```bash
clamscan -r /path/to/scan --log=/var/log/clamav/scan.log
```

---

### **4. Scan Compressed & Archive Files**
```bash
clamscan --scan-archive=yes -r /path/to/directory
```

---

### **5. Enable & Use ClamAV Daemon (clamd)**
#### **Start ClamAV Daemon:**
```bash
sudo systemctl start clamav-daemon
```
#### **Enable ClamAV Daemon at boot:**
```bash
sudo systemctl enable clamav-daemon
```
#### **Check ClamAV Daemon status:**
```bash
sudo systemctl status clamav-daemon
```
#### **Scan using ClamAV Daemon (faster than clamscan):**
```bash
clamdscan /path/to/scan
```

---

### **6. Advanced Scanning Options**
#### **Scan for potentially unwanted applications (PUA):**
```bash
clamscan --detect-pua=yes -r /path/to/directory
```
#### **Scan for email phishing & malware:**
```bash
clamscan --phishing-sigs=yes -r /path/to/emails
```
#### **Limit number of scanned files (for performance):**
```bash
clamscan --max-files=50 -r /path/to/directory
```

---

### **7. View & Edit ClamAV Configuration**
#### **Edit ClamAV Daemon configuration:**
```bash
sudo nano /etc/clamav/clamd.conf
```
#### **Edit ClamAV Freshclam configuration:**
```bash
sudo nano /etc/clamav/freshclam.conf
```

---

### **8. View ClamAV Logs**
```bash
cat /var/log/clamav/clamav.log
```

---

### **9. Schedule Automatic Scans (Cron Job)**
To schedule a daily scan at 2 AM, add this line to `crontab`:
```bash
0 2 * * * clamscan -r /home/user --log=/var/log/clamav_scan.log
```

---

### **10. Restart ClamAV Services**
```bash
sudo systemctl restart clamav-daemon
```

---

### **11. Uninstall ClamAV**
#### **On Debian/Ubuntu:**
```bash
sudo apt remove --purge clamav clamav-daemon -y
```
#### **On RHEL/CentOS:**
```bash
sudo yum remove clamav clamav-update -y
```

---

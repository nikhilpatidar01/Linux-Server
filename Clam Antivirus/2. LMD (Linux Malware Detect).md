### 🔥 **Linux Malware Detect (LMD) Installation & Usage**  

LMD (Linux Malware Detect) is a **malware scanning tool** designed to detect and remove malware from Linux servers. It is widely used in **web hosting** and **server environments** to protect against infected files.  

---

## 🚀 **Step 1: Install LMD in Linux**  
LMD is not available in the default package managers, so we need to **download and install** it manually.  

### 📥 **Download & Install LMD**
```bash
wget https://www.rfxn.com/downloads/maldetect-current.tar.gz  # Download the package
tar -xvf maldetect-current.tar.gz  # Extract the package
cd maldetect-*  # Move into the extracted directory
sh install.sh  # Install LMD
```

### 📍 **Verify Installation**
After installation, check the LMD version:  
```bash
maldet --version
```

---

## 🔧 **Step 2: Update Malware Signatures**
Before scanning, update the malware signature database:  
```bash
maldet -u
```

---

## 🕵️ **Step 3: Scan for Malware**
### 🔹 **Scan a Specific Directory**
```bash
maldet -a /var/www/html
```
This scans the `/var/www/html` directory for malware.

### 🔹 **Scan Home Directory**
```bash
maldet -a /home
```

### 🔹 **Real-time Monitoring**
To enable real-time monitoring of a directory:
```bash
maldet --monitor /home
```

---

## 📜 **Step 4: View Scan Reports**
After scanning, LMD generates a **report ID**. Use the following command to check the report:
```bash
maldet --report SCAN_ID
```
Example:
```bash
maldet --report 123456-7890.1234
```

---

## 🛠 **Step 5: Remove or Clean Malware**
If LMD detects malware, you can **remove or quarantine** infected files.  

### 🔸 **Quarantine Infected Files**
```bash
maldet -q SCAN_ID
```

### 🔸 **Delete Infected Files**
```bash
maldet --clean SCAN_ID
```

---

## 🔥 **Step 6: Enable ClamAV for Better Detection**  
LMD can be integrated with ClamAV for **better malware detection**.  

### **Enable ClamAV in LMD Configuration**
Edit the configuration file:  
```bash
vi /usr/local/maldetect/conf.maldet
```
Find this line and **change `0` to `1`**:
```bash
scan_clamscan="1"
```
Save and exit, then restart LMD:
```bash
maldet -u
```

---

## 🎯 **Step 7: Automate Malware Scans**  
To **schedule daily malware scans**, add this to **cron jobs**:
```bash
crontab -e
```
Add:
```bash
0 2 * * * maldet -a /var/www/html >> /var/log/maldet.log 2>&1
```
This will **scan `/var/www/html` every day at 2 AM**.

---


# Samba SMB CIFS Server
## Samba/SMB/CIFS Server
**SMB (Server Message Block)** is a protocol used for sharing files and printers over a network, mostly in Windows environments. **Samba** is a free, open-source software that allows Linux systems to use the SMB protocol, making it possible to share files with Windows computers or access Windows shares from Linux. In short, Samba lets Linux and Windows talk to each other and share files on the same network.

---

### Overview 
 - **SMB (Server Message Block)** is a network protocol used for file and printer sharing, primarily in Windows environments.
 - **CIFS (Common Internet File System)** is a version of SMB designed for better compatibility across different systems, but it is now considered outdated.
  - **Samba** is open-source software that allows Linux and Unix-based systems to communicate using the SMB/CIFS protocol, enabling them to share files with Windows systems and access Windows shared resources.
---

### âš™ï¸ **Common Use Cases:**
- Share files/folders between **Linux and Windows**
- Set up a **home or office file server**
- Join Linux to a **Windows domain**
- Enable Linux to **access Windows shared drives**

---

### ğŸ“ **Common Paths:**

| Purpose              | Path                                 |
|----------------------|--------------------------------------|
| Samba config file    | `/etc/samba/smb.conf`                |
| Samba credentials    | `/etc/samba/credentials` (custom)    |
| Samba logs           | `/var/log/samba/`                    |
| Default shared dir   | Custom (e.g., `/srv/samba/shared`)   |
| Mount point (client) | Custom (e.g., `/mnt/smb_share`)      |

---

### ğŸ”§ **Typical Server Config (`smb.conf` snippet):**
```ini
[SharedFiles]
   path = /srv/samba/shared
   browseable = yes
   writable = yes
   guest ok = yes
   create mask = 0660
   directory mask = 0770
```

---

##  1. Install SMB Client Tools

### ğŸ”´ CentOS/RHEL:
```bash
sudo dnf install samba-client cifs-utils -y
```

### ğŸŸ¢ Debian/Ubuntu/Kali:
```bash
sudo apt update
sudo apt install smbclient cifs-utils -y
```

---

## ğŸ” 2. Discover SMB Shares on a Server

Use `smbclient` to list available shares:

```bash
smbclient -L //server-ip-or-hostname -U username
```

Example (with guest access):
```bash
smbclient -L //192.168.1.100 -U guest
```

---

## ğŸ“‚ 3. Connect to a Remote Share (Interactive Shell)

```bash
smbclient //server-ip/Sharename -U username
```

Example:
```bash
smbclient //192.168.1.100/SharedFiles -U user1
```

Inside the `smb:` prompt, you can use:
- `ls` â€” list files
- `cd` â€” change directory
- `get filename` â€” download file
- `put filename` â€” upload file
- `exit` â€” quit

---

## ğŸ” 4. Mount SMB Share to Local Directory

Create a mount point:
```bash
sudo mkdir -p /mnt/smb_share
```

### Mount with Credentials:
```bash
sudo mount -t cifs //server-ip/Sharename /mnt/smb_share -o username=your_user,password=your_pass,iocharset=utf8
```

### Example:
```bash
sudo mount -t cifs //192.168.1.100/SharedFiles /mnt/smb_share -o username=user1,password=yourpass
```

> âœ… Use `vers=3.0`, `vers=2.1`, etc. if needed:  
```bash
-o username=user1,password=yourpass,vers=3.0
```

---

## ğŸ” 5. Store Credentials Securely

Create a file:
```bash
sudo nano /etc/samba/credentials
```

Add:
```
username=your_user
password=your_pass
```

Set permissions:
```bash
sudo chmod 600 /etc/samba/credentials
```

Mount using:
```bash
sudo mount -t cifs //192.168.1.100/SharedFiles /mnt/smb_share -o credentials=/etc/samba/credentials,iocharset=utf8
```

---

## ğŸ“Œ 6. Persistent Mount via `/etc/fstab`

Add to `/etc/fstab`:
```fstab
//192.168.1.100/SharedFiles /mnt/smb_share cifs credentials=/etc/samba/credentials,iocharset=utf8,uid=1000,gid=1000 0 0
```

Reload mounts:
```bash
sudo mount -a
```

---

## ğŸ§ª 7. Troubleshooting

- View mount errors:
  ```bash
  dmesg | grep CIFS
  journalctl -xe
  ```

- Check required kernel support:
  ```bash
  modinfo cifs
  ```

---

## ğŸ“¦ Common Tools Summary

| Tool          | Purpose                              |
|---------------|--------------------------------------|
| `smbclient`   | CLI tool to connect to SMB shares    |
| `cifs-utils`  | Provides CIFS mount support          |
| `nmblookup`   | Find NetBIOS names on the network    |
| `smbtree`     | Graphically browse SMB network shares|

---

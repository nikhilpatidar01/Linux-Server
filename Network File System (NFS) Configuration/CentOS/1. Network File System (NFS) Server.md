
# **Network File System (NFS) Setup**

## **Introduction**
A **Network File System (NFS) Server** allows users to access, share, and manage files over a network as if they were stored locally. Developed by **Sun Microsystems** in 1984, NFS is widely used in UNIX, Linux, and Windows environments.

---

## **What is NFS Server?**
An **NFS server** is a machine that provides file access to multiple clients using the **NFS protocol**. This enables seamless file sharing and centralized storage management.

### **How NFS Works**
1. The **NFS Server** exports directories for sharing.  
2. The **NFS Client** mounts these directories over the network.  
3. Clients access and manipulate files as if stored locally.  
4. Any changes made by one client are visible to all others in real time.

### **Key Features**
- Remote File Access  
- Centralized Storage  
- Multi-User Access  
- Security and Authentication  
- Scalability  
- Performance Optimization with Caching

---

## **Advantages of NFS**
тЬФ **Cost-Effective** тАУ No additional software required.  
тЬФ **Seamless Integration** тАУ Works with Linux, UNIX, and Windows.  
тЬФ **Easy to Configure** тАУ Simple setup and management.  
тЬФ **Efficient File Sharing** тАУ Reduces redundancy and improves collaboration.  

---

## **Disadvantages of NFS**
тЬЦ **Security Risks** тАУ Improper configuration can expose sensitive data.  
тЬЦ **Performance Issues** тАУ Can be slow over busy networks.  
тЬЦ **Reliability** тАУ If the NFS server goes down, all clients lose access.  

---

## **1. Install NFS Packages**

### **Check if NFS packages are installed:**
```bash
rpm -qa | grep nfs
```

### **Install NFS packages:**
```bash
yum install nfs-utils
```
### **Install rpcbind (required for NFS):**
```bash
yum install rpcbind
```


### **Check information about the NFS package:**
```bash
rpm -qi nfs-utils
```

### **List files installed by nfs-utils:**
```bash
rpm -ql nfs-utils
```

### **List documentation for nfs-utils:**
```bash
rpm -qd nfs-utils
```

### **List configuration files for nfs-utils:**
```bash
rpm -qc nfs-utils
```


### **2. Enable and start NFS services:**

Enable Services to Start on Boot.
```bash
systemctl enable rpcbind
```
```bash
systemctl enable nfs-server
```


Start Services Now.

```bash
systemctl start rpcbind
```
```bash
systemctl start nfs-server
```





### **3. Create a directory for sharing (e.g., /data):**
```bash
mkdir -p /data
```

### **Set permissions to allow full access (read, write, execute):**
```bash
chmod 777 /data
```

### **4. Configure NFS exports:**
Edit the /etc/exports file.
```bash
vim /etc/exports
```

#### **Example `/etc/exports` configuration:**
```apache
#Allow read-write with sync
/data/ *(rw,sync)

# Read-only access
# /data/ 192.168.1.0/24(ro.sync)

# Alloe root privileges (use with cautiion)
#/data/ 192.168.1.0/24(rw, sync, no_root_squash, no_all_squash)
```

#### **Explanation of options:**
- **/data**: Shared directory  
- **192.168.1.0/24**: Network range of clients that can access the shared directory  
- **rw**: Read-write permission  
- **sync**: Synchronous writes for better data integrity  
- **no_root_squash** *(optional)*: Allows root on the client to have root access on the server  
- **no_all_squash** *(optional)*: Keeps client users' UID and GID intact  

### **Export the directory to clients:**
```bash
exportfs -rav
```
Optional: Verify Exports.
```bash
exportfs -v
```

### **Restart NFS server to apply changes:**
```bash
systemctl restart nfs-server
```

### **5. Open NFS Ports in Firewalld**
Enable and Start Firewalld
```apache
systemctl enable firewalld
```
```apache
systemctl start firewalld
```

Allow NFS-related ports (20048, 2049, 111) in the firewall
```apache
firewall-cmd --permanent --add-port=2049/tcp
```
```apache
firewall-cmd --permanent --add-port=111/tcp
```
```apache
firewall-cmd --permanent --add-port=20048/tcp
```

Add NFS Services to firewalld permanently
```apache
firewall-cmd --permanent --add-service=nfs
```
```apache
firewall-cmd --permanent --add-service=mountd
```
```apache
firewall-cmd --permanent --add-service=rpc-bind
```

## **Reload firewalld to apply the changes:**
```bash
firewall-cmd --reload
```

Optional Verify open ports.
```bash
firewall-cmd --list-all
```

## **6. NFS Client Setup**

### **Install required packages on the client machine:**
```bash
yum install rpcbind nfs-utils
```
```bash
yum install showmount
```

### Notes:-
- rw - Writable access
- ro - Read Only
- sync - Ensures data is written to disk before responding
- no_root_squach - Allows root access on client (insecure in prod)
- no_all_squash - Preserves UID/GID from client
---

### **Check the shared directories on the NFS server:**

Check the status of the NFS Server.
```bashsy
systemctl status nfs-server
```

View system log entries for errors.
```bash
journalctl -xe
```
Check visibility of exports from the client.
```bash
showmount -e 192.168.1.10
```


### **Create a mount point on the client:**
```bash
mkdir /mnt/d1
```

### **Mount the NFS share:**
```bash
mount -t nfs 192.168.1.10:/data /mnt/d1/
```

### **Verify the mount:**
```bash
df -h  # Check if the NFS share is mounted successfully
```

### **Make the mount persistent by editing `/etc/fstab`:**
```bash
vim /etc/fstab
```

#### **Add the following line to the file:**
```
192.168.1.10:/data  /mnt/d1  nfs  rw,sync,hard,intr  0  0
```

### **To apply changes in `/etc/fstab`:**
```bash
mount -a
```
---

## ЁЯз▓ What is Mounting.

**Mounting** рдХрд╛ рдорддрд▓рдм рд╣реЛрддрд╛ рд╣реИ тАУ  
ЁЯСЙ **рдХрд┐рд╕реА рдлреЛрд▓реНрдбрд░ рдпрд╛ рдбреНрд░рд╛рдЗрд╡ рдХреЛ рдЕрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЬреЛрдбрд╝рдирд╛** рддрд╛рдХрд┐ рдЖрдк рдЙрд╕реЗ рдРрд╕реЗ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХреЗрдВ рдЬреИрд╕реЗ рд╡реЛ рдЖрдкрдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛред

---

### ЁЯФз Easy way to Explain:

рд╕реЛрдЪреЛ рдЖрдкрдХреЗ рджреЛрд╕реНрдд рдХреЗ рдкреЗрдирдбреНрд░рд╛рдЗрд╡ рдореЗрдВ рдЧрд╛рдиреЗ рд╣реИрдВред  
рдЬрдм рдЖрдк рд╡реЛ рдкреЗрдирдбреНрд░рд╛рдЗрд╡ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдореЗрдВ рд▓рдЧрд╛рддреЗ рд╣реЛ, рддреЛ рд╡реЛ **"рдорд╛рдЙрдВрдЯ"** рд╣реЛ рдЬрд╛рддреА рд╣реИред  
рдЕрдм рдЖрдк "This PC" рдореЗрдВ рдЬрд╛рдХрд░ рдЙрд╕ рдкреЗрдирдбреНрд░рд╛рдЗрд╡ рдХреЛ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реЛ тАУ рдЬреИрд╕реЗ рдЖрдкрдХреА рдЕрдкрдиреА рд╣реЛред

**рдмрд╕ рд╡реИрд╕рд╛ рд╣реА NFS рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ**, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рдкреЗрдирдбреНрд░рд╛рдЗрд╡ рдХреА рдЬрдЧрд╣ рдПрдХ **рджреВрд╕рд░рд╛ рдХрдВрдкреНрдпреВрдЯрд░** рд╣реИред

---

## ЁЯУБ NFS рдореЗрдВ Mounting рдХреИрд╕реЗ рд╣реЛрддреА рд╣реИ?

- NFS Server рдкрд░ рдПрдХ рдлреЛрд▓реНрдбрд░ рд╢реЗрдпрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  
- Client рдХрдВрдкреНрдпреВрдЯрд░ рдЙрд╕ рдлреЛрд▓реНрдбрд░ рдХреЛ рдЕрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **mount** рдХрд░рддрд╛ рд╣реИред

рдЕрдм Client рдЙрд╕ рдлреЛрд▓реНрдбрд░ рдХреЛ рдРрд╕реЗ рдЦреЛрд▓ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рд╡реЛ **рдЙрд╕рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╣реА рд╣реЛ**, рдЬрдмрдХрд┐ рдЕрд╕рд▓ рдореЗрдВ рд╡реЛ рдлреЛрд▓реНрдбрд░ Server рдкрд░ рд╣реЛрддрд╛ рд╣реИред

---

### ЁЯза Example:

```
NFS Server: /home/data (рд╢реЗрдпрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдлреЛрд▓реНрдбрд░)

Client рдкрд░ рдЗрд╕реЗ /mnt/shared рдкрд░ рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛

рдЕрдм Client рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ /mnt/shared рдЦреЛрд▓реЗрдВрдЧреЗ, рддреЛ /home/data рдХреА рдлрд╛рдЗрд▓реЗрдВ рджрд┐рдЦреЗрдВрдЧреАред
```

---

## ЁЯФД Unmounting рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ?

Mounting рдХрд╛ рдЙрд▓реНрдЯрд╛ рд╣реЛрддрд╛ рд╣реИ **Unmounting** тАУ рдпрд╛рдиреА рдЙрд╕ рдлреЛрд▓реНрдбрд░ рдХреЛ рд╣рдЯрд╛рдирд╛, рдЬрд┐рд╕рд╕реЗ рд╡реЛ рдлрд┐рд░ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рджрд┐рдЦрд╛рдИ рди рджреЗред

---

## ЁЯОп Mounting рдХрд╛ рдлрд╛рдпрджрд╛:

тЬЕ рдЖрдк рджреВрд╕рд░реА рдорд╢реАрди рдХреА рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рд╕реАрдзрд╛ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ  
тЬЕ рдХреЙрдкреА-рдкреЗрд╕реНрдЯ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ  
тЬЕ рдХрд╛рдо рдЖрд╕рд╛рди рдФрд░ рддреЗрдЬрд╝ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ

---
